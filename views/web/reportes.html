{% extends "base.html" %}

{% block title %}Reportes - Clínica Ham{% endblock %}

{% block page_title %}Reportes{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/reportes.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}

<div class="card report-config">
    <h3>Configuración del Reporte</h3>
    <div class="config-grid">
        <div class="config-item">
            <label for="reportType">Tipo de Reporte</label>
            <select class="filter-select" id="reportType">
                <option value="citas">Citas Atendidas</option>
                <option value="pacientes">Pacientes</option>
                <option value="medicos">Médicos</option>
                <option value="especialidades">Especialidades</option>
            </select>
        </div>
        
        <div class="config-item">
            <label for="reportPeriod">Período</label>
            <select class="filter-select" id="reportPeriod">
                <option value="today">Hoy</option>
                <option value="week">Esta Semana</option>
                <option value="month" selected>Este Mes</option>
                <option value="quarter">Este Trimestre</option>
                <option value="year">Este Año</option>
                <option value="custom">Personalizado</option>
            </select>
        </div>
        
        <div class="config-item">
            <label for="reportDepartment">Departamento</label>
            <select class="filter-select" id="reportDepartment">
                <option value="all">Todos</option>
                <option value="cardiologia">Cardiología</option>
                <option value="pediatria">Pediatría</option>
                <option value="medicina-general">Medicina General</option>
                <option value="traumatologia">Traumatología</option>
            </select>
        </div>
        
        <div class="config-item">
            <button class="btn btn-primary" id="generateReportBtn">
                <i class="fas fa-chart-bar"></i>
                Generar Reporte
            </button>
        </div>
    </div>
</div>

<div class="charts-grid">
    <div class="card chart-card">
        <h3>Citas Atendidas por Médico</h3>
        <canvas id="citasPorMedicoChart"></canvas>
    </div>
    
    <div class="card chart-card">
        <h3>Distribución de Servicios</h3>
        <canvas id="distribucionServiciosChart"></canvas>
    </div>
</div>

<div class="metrics-grid">
    <div class="metric-card">
        <div class="metric-icon blue">
            <i class="fas fa-calendar-check"></i>
        </div>
        <div class="metric-content">
            <p class="metric-label">Citas Totales</p>
            <h2 class="metric-value" data-target="750">0</h2>
            <p class="metric-change positive">
                <i class="fas fa-arrow-up"></i>
                12% vs mes anterior
            </p>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon green">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="metric-content">
            <p class="metric-label">Completadas</p>
            <h2 class="metric-value" data-target="725">0</h2>
            <p class="metric-change positive">
                <i class="fas fa-arrow-up"></i>
                10% vs mes anterior
            </p>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon yellow">
            <i class="fas fa-user-plus"></i>
        </div>
        <div class="metric-content">
            <p class="metric-label">Pacientes Nuevos</p>
            <h2 class="metric-value" data-target="120">0</h2>
            <p class="metric-change positive">
                <i class="fas fa-arrow-up"></i>
                15% vs mes anterior
            </p>
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-icon red">
            <i class="fas fa-times-circle"></i>
        </div>
        <div class="metric-content">
            <p class="metric-label">Cancelaciones</p>
            <h2 class="metric-value" data-target="25">0</h2>
            <p class="metric-change negative">
                <i class="fas fa-arrow-down"></i>
                5% vs mes anterior
            </p>
        </div>
    </div>
</div>

<div class="card">
    <div class="table-header">
        <h3>Detalle de Citas Recientes</h3>
        <div class="table-actions">
            <button class="btn btn-outline" id="exportPdfBtn">
                <i class="fas fa-file-pdf"></i>
                Exportar PDF
            </button>
            <button class="btn btn-outline" id="exportCsvBtn">
                <i class="fas fa-file-csv"></i>
                Exportar CSV
            </button>
        </div>
    </div>
    
    <div class="table-container">
        <table class="report-table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Médico</th>
                    <th>Paciente</th>
                    <th>Especialidad</th>
                    <th>Duración</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>20 Oct 2025</td>
                    <td>Dr. Alejandro Gómez</td>
                    <td>Ana Torres</td>
                    <td>Cardiología</td>
                    <td>45 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>20 Oct 2025</td>
                    <td>Dra. María García</td>
                    <td>Luis Morales</td>
                    <td>Pediatría</td>
                    <td>30 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>19 Oct 2025</td>
                    <td>Dr. Carlos Martínez</td>
                    <td>Carmen Ruiz</td>
                    <td>Medicina General</td>
                    <td>30 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>19 Oct 2025</td>
                    <td>Dr. Luis Rodríguez</td>
                    <td>Pedro Sánchez</td>
                    <td>Cardiología</td>
                    <td>60 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>18 Oct 2025</td>
                    <td>Dra. Ana López</td>
                    <td>María Fernández</td>
                    <td>Traumatología</td>
                    <td>45 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>18 Oct 2025</td>
                    <td>Dra. Sofía Hernández</td>
                    <td>Jorge Ramírez</td>
                    <td>Pediatría</td>
                    <td>30 min</td>
                    <td><span class="status-dot status-cancelado"></span> Cancelado</td>
                </tr>
                <tr>
                    <td>17 Oct 2025</td>
                    <td>Dr. Alejandro Gómez</td>
                    <td>Isabel Vargas</td>
                    <td>Cardiología</td>
                    <td>45 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
                <tr>
                    <td>17 Oct 2025</td>
                    <td>Dr. Carlos Martínez</td>
                    <td>Roberto Díaz</td>
                    <td>Medicina General</td>
                    <td>30 min</td>
                    <td><span class="status-dot status-completado"></span> Completado</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/reportes.js') }}"></script>
{% endblock %}
